# Bloodhound

## Intro

### BloodHound

Инструмент для сбора и анализа информации об Active Directory

Link: [https://github.com/BloodHoundAD/BloodHound](https://github.com/BloodHoundAD/BloodHound)

### Neo4j & Cipher

BloodHound использует для хранения Neo4j графовую базу. У этой базы язык запросов - Cipher.\
Заметки по этому языку: ﻿﻿﻿[https://hausec.com/2019/09/09/bl](https://hausec.com/2019/09/09/bloodhound-cypher-cheatsheet/)[oodhound-cypher-cheatsheet/](https://hausec.com/2019/09/09/bloodhound-cypher-cheatsheet/)

neo4j можно поднять в докере [https://hub.docker.com/\_/neo4j/](https://hub.docker.com/\_/neo4j/)

С ней отлично работает BloodHound

Поднимаем базу, подключаемся на интерфейсе `http://localhost:7474` к ней по УЗ `neo4j/neo4j` и меняем пароль. После можем коннектиться к ней BloodHound'ом.

## Install & Usage

Разбивается на два этапа — запустить neo4j и подключить к ней bloodhound

### Kali

#### Install

```
kali> apt-get install bloodhound 
```

#### Старт

```
kali> neo4j console - запускаем базу 
kali> bloodhound - коннектимся к ней 
```

### MacOS

Забираем сборку со страницы релиза [BloodHound](https://github.com/BloodHoundAD/BloodHound/releases) или собираем сами по [инструкции](https://bloodhound.readthedocs.io/en/latest/installation/osx.html).

### Траблы

Если открыли BloodHound, а он выдает пустое окно, то жмем Ctrl-R - это обновит страницу

### Usage

У BloodHound в паре есть инструмент — Ingestor — для сбора информации с целевой системы или с Azure.&#x20;

```
Собрать максимально информации: 
    .\SharpHound.exe -c All,LoggedOn
    
Минимум запросов — делать запросы только к DC:
    .\SharpHound.exe -c DCOnly
    
Максимально тихо (делаем запросы реже?): 
    .\SharpHound.exe --Stealth
```

#### C\#

Repo: [https://github.com/BloodHoundAD/SharpHound3](https://github.com/BloodHoundAD/SharpHound3)

builds: Powershell или exe: [https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors](https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors)

#### Python

Ребята из Fox-IT переписали на python то же самое с использованием Impacket'а

Link: [https://github.com/fox-it/BloodHound.py](https://github.com/fox-it/BloodHound.py)

## Кастомные запросы

Набор кастомных запросов для BloodHound. Например: Find groups that can reset passwords, Find all users that have local admin rights, Find all computers with Unconstrained Delegation: [https://gist.github.com/seajaysec/a4d4a545047a51053d52cba567f78a9b](https://gist.github.com/seajaysec/a4d4a545047a51053d52cba567f78a9b)

## Papers & Links

Книжка по BloodHound, описывающая все фишки этого инструмента

{% file src="../../../.gitbook/assets/ERNW_DogWhisperer3.pdf" %}

Еще здесь можно почитать про BloodHound: [https://en.hackndo.com/bloodhound/](https://en.hackndo.com/bloodhound/)
